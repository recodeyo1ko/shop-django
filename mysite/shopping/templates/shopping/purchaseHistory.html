{% load static %}
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>購入履歴</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'shopping/css/style.css' %}"
    />
  </head>
  <body>
    <h3>購入履歴の一覧</h3>

    {% if message %}
    <p>{{ message }}</p>
    {% endif %}
    <table>
      <tr>
        <th>注文日</th>
        <th>購入商品</th>
        <th>配送先</th>
        <th></th>
      </tr>
      {% for purchase in purchases %}
      <tr>
        <td>{{ purchase.purchase_date }}</td>
        <td>
          <table>
            <tr>
              <th>商品名</th>
              <th>色</th>
              <th>メーカー</th>
              <th>単価</th>
              <th>数量</th>
            </tr>
            {% for item in purchase.purchasedetail_set.all %}
            <tr>
              <td>{{ item.item.name }}</td>
              <td>{{ item.item.color }}</td>
              <td>{{ item.item.manufacturer }}</td>
              <td>{{ item.item.price }}</td>
              <td>{{ item.amount }}</td>
            </tr>
            {% endfor %}
          </table>
        </td>
        <td>{{purchase.address }}</td>
        <td>
          <a href="{% url 'shopping:purchase_cancel' purchase.id %}"
            >キャンセル</a
          >
        </td>
      </tr>

      {% endfor %}
    </table>

    <a href="{% url 'shopping:cart' %}">カートに戻る</a>
    <br />
    <a href="{% url 'shopping:index' %}">商品検索</a>へ<br />
  </body>
</html>
